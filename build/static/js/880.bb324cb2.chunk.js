"use strict";(self.webpackChunksommelier=self.webpackChunksommelier||[]).push([[880],{7880:(e,t,s)=>{s.r(t),s.d(t,{RestaurantListOnCategory:()=>S,default:()=>j});var a=s(9950),r=s(9351),o=s(8341),l=s(8858),i=s(3507),c=s(1580),n=s.n(c),g=s(9400),h=s(8429),d=s(2515),u=s(1947),m=s(480),p=s.n(m),x=s(4414);class S extends a.Component{constructor(){super(...arguments),this.state={selectedOption:null,options:[],defaultValues:[],checkboxChecked:!1,checkedCount:0,loading:!0},this._processSelectedCheckboxs=()=>{this.setState({loading:!0});let e=[],t=document.querySelectorAll("input[type=checkbox]:checked");if(this.setState({checkedCount:t.length}),0!==t.length){for(let s=0;s<t.length;s++)e.push({value:parseInt(t[s].getAttribute("data-value")),label:t[s].getAttribute("data-label")});return new Promise(((t,s)=>{localStorage.setItem("categorySelectOptions",JSON.stringify(e));let a=JSON.parse(localStorage.getItem("categorySelectOptions")),r=JSON.parse(localStorage.getItem("userSetAddress"));if(a){let e=[];a.map((t=>e.push(parseInt(t.value)))),this.props.getRestaurantsBasedOnCategory(r.lat,r.lng,e)}JSON.parse(localStorage.getItem("categorySelectOptions"))?t(this.sortRestaurantCategoriesOptions()):s(new Error("Promise rejected"))}))}console.log("Came here"),localStorage.removeItem("categorySelectOptions")},this.callAfterDefaultRestaurantsCategoriesSelected=()=>{this.handleChange(this.state.defaultValues)},this.selectRestaurantsCategories=e=>{let t=[];if(e&&(e.categories.map((e=>{let s={value:e.id,label:e.name};return s&&t.push(s),null})),t.length>0))return this.setState({options:t}),localStorage.setItem("allSelectableOptions",JSON.stringify(t)),new Promise(((e,t)=>{JSON.parse(localStorage.getItem("allSelectableOptions"))?e(this.sortRestaurantCategoriesOptions()):t(new Error("Promise rejected"))}))},this.checkIfChecked=e=>JSON.parse(localStorage.getItem("categorySelectOptions")).some((t=>e===t.value)),this.sortRestaurantCategoriesOptions=()=>{let e=JSON.parse(localStorage.getItem("categorySelectOptions")),t=JSON.parse(localStorage.getItem("allSelectableOptions")),s=new Set(e.map((e=>e.value))),a=[...e,...t.filter((e=>!s.has(e.value)))];a.length===t.length&&this.setState({options:a})}}componentDidMount(){this.props.getRestaurantsCategories(),this.setState({checkedCount:JSON.parse(localStorage.getItem("categorySelectOptions")).length})}filterRestaurants(){let e=JSON.parse(localStorage.getItem("categorySelectOptions")),t=JSON.parse(localStorage.getItem("userSetAddress"));if(e){let s=[];e.map((e=>s.push(parseInt(e.value)))),this.props.getRestaurantsBasedOnCategory(t.lat,t.lng,s)}}componentWillReceiveProps(e){this.props.restaurants_categories.categories!==e.restaurants_categories.categories&&this.setState({selectedOption:e.restaurants_categories.categories}),this.props.filtered_restaurants!==e.filtered_restaurants&&this.setState({loading:!1})}componentDidUpdate(e){this.props.restaurants_categories!==e.restaurants_categories&&(this.filterRestaurants(),this.selectRestaurantsCategories(this.props.restaurants_categories))}render(){if(window.innerWidth>768)return(0,x.jsx)(h.C5,{to:"/"});if(null===localStorage.getItem("categorySelectOptions"))return(0,x.jsx)(h.C5,{to:"/"});if(null===localStorage.getItem("userSetAddress"))return console.log("Navigate to search location"),(0,x.jsx)(h.C5,{to:"/search-location"});const{selectedOption:e}=this.state,{history:t,user:s}=this.props;return(0,x.jsxs)(a.Fragment,{children:[(0,x.jsx)(d.A,{seotitle:localStorage.getItem("seoMetaTitle"),seodescription:localStorage.getItem("seoMetaDescription"),ogtype:"website",ogtitle:localStorage.getItem("seoOgTitle"),ogdescription:localStorage.getItem("seoOgDescription"),ogurl:window.location.href,twittertitle:localStorage.getItem("seoTwitterTitle"),twitterdescription:localStorage.getItem("seoTwitterDescription")}),(0,x.jsx)(u.A,{logo:!0,logoLink:!0,active_nearme:!0,disable_back_button:!0,history:t,loggedin:s.success}),this.state.options.length>0&&null!==e&&(0,x.jsx)(a.Fragment,{children:(0,x.jsxs)("div",{className:"category-checkboxes-block px-15 mt-20",ref:"categoryOptions",children:[(0,x.jsxs)("div",{className:"filter-count-block",children:[localStorage.getItem("categoriesFiltersText")," ",this.state.checkedCount]}),this.state.options.map((e=>(0,x.jsxs)("label",{style:{position:"relative"},children:[(0,x.jsx)("input",{type:"checkbox",value:e.value,defaultChecked:this.checkIfChecked(e.value),onChange:this._processSelectedCheckboxs,"data-label":e.label,"data-value":e.value}),(0,x.jsx)("span",{children:e.label}),(0,x.jsx)(n(),{duration:"500",hasTouch:!0})]},e.value)))]})}),this.state.loading?(0,x.jsxs)(l.Ay,{height:378,width:400,speed:1.2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb",children:[(0,x.jsx)("rect",{x:"20",y:"20",rx:"4",ry:"4",width:"80",height:"78"}),(0,x.jsx)("rect",{x:"144",y:"30",rx:"0",ry:"0",width:"115",height:"18"}),(0,x.jsx)("rect",{x:"144",y:"60",rx:"0",ry:"0",width:"165",height:"16"}),(0,x.jsx)("rect",{x:"20",y:"145",rx:"4",ry:"4",width:"80",height:"78"}),(0,x.jsx)("rect",{x:"144",y:"155",rx:"0",ry:"0",width:"115",height:"18"}),(0,x.jsx)("rect",{x:"144",y:"185",rx:"0",ry:"0",width:"165",height:"16"}),(0,x.jsx)("rect",{x:"20",y:"270",rx:"4",ry:"4",width:"80",height:"78"}),(0,x.jsx)("rect",{x:"144",y:"280",rx:"0",ry:"0",width:"115",height:"18"}),(0,x.jsx)("rect",{x:"144",y:"310",rx:"0",ry:"0",width:"165",height:"16"})]}):(0,x.jsx)(a.Fragment,{children:0===this.props.filtered_restaurants.length?(0,x.jsxs)(a.Fragment,{children:[(0,x.jsx)("div",{className:"d-flex justify-content-center mt-100",children:(0,x.jsx)("img",{className:"explore-bg",src:"/assets/img/various/explore-bg.png",alt:localStorage.getItem("restaurantSearchPlaceholder")})}),(0,x.jsx)("h4",{className:"d-flex justify-content-center filter-no-found",children:localStorage.getItem("categoriesNoRestaurantsFoundText")})]}):this.props.filtered_restaurants.map(((e,t)=>(0,x.jsxs)(a.Fragment,{children:[(0,x.jsx)("div",{className:"col-xs-12 col-sm-12 restaurant-block",children:(0,x.jsxs)(i.A,{to:"../stores/"+e.slug,delay:200,className:"block text-center mb-3",clickAction:()=>{},children:[(0,x.jsxs)("div",{className:"block-content block-content-full ".concat(e.is_featured&&e.is_active?"ribbon ribbon-bookmark ribbon-warning pt-2":"pt-2"," "),children:[e.is_featured?(0,x.jsx)(a.Fragment,{children:null==e.custom_featured_name?(0,x.jsx)("div",{className:"ribbon-box",children:localStorage.getItem("restaurantFeaturedText")}):(0,x.jsx)("div",{className:"ribbon-box",children:e.custom_featured_name})}):null,(0,x.jsx)(p(),{duration:500,children:(0,x.jsx)("img",{src:e.image,alt:e.name,className:"restaurant-image ".concat(!e.is_active&&"restaurant-not-active")})})]}),(0,x.jsxs)("div",{className:"block-content block-content-full restaurant-info",children:[(0,x.jsx)("div",{className:"font-w600 mb-5 text-dark",children:e.name}),(0,x.jsx)("div",{className:"font-size-sm text-muted truncate-text text-muted",children:e.description}),!e.is_active&&(0,x.jsx)("span",{className:"restaurant-not-active-msg",children:localStorage.getItem("restaurantNotActiveMsg")}),(0,x.jsx)("hr",{className:"my-10"}),(0,x.jsxs)("div",{className:"text-center restaurant-meta mt-5 d-flex align-items-center justify-content-between text-muted",children:[(0,x.jsxs)("div",{className:"col-2 p-0 text-left",children:[(0,x.jsx)("i",{className:"fa fa-star pr-1",style:{color:localStorage.getItem("storeColor")}})," ","0"===e.avgRating?e.rating:e.avgRating]}),(0,x.jsxs)("div",{className:"col-4 p-0 text-center",children:[(0,x.jsx)("i",{className:"si si-clock pr-1"})," ",e.delivery_time," ",localStorage.getItem("homePageMinsText")]}),(0,x.jsxs)("div",{className:"col-6 p-0 text-center",children:[(0,x.jsx)("i",{className:"si si-wallet pr-1"})," ","left"===localStorage.getItem("currencySymbolAlign")&&localStorage.getItem("currencyFormat"),e.price_range," ","right"===localStorage.getItem("currencySymbolAlign")&&localStorage.getItem("currencyFormat"),localStorage.getItem("homePageForTwoText")]})]})]}),(0,x.jsx)(n(),{duration:"500",hasTouch:!1})]})}),"true"===localStorage.getItem("showPromoSlider")&&(0,x.jsx)(a.Fragment,{children:this.props.slides&&this.props.slides.length>0&&(0,x.jsx)(a.Fragment,{children:t===this.props.slides[0].promo_slider.position_id-1&&(0,x.jsx)(g.A,{slides:this.props.slides,size:this.props.slides[0].promo_slider.size,secondarySlider:!0})})})]},e.id)))})]})}}const j=(0,o.Ng)((e=>({restaurants_categories:e.restaurant.restaurants_categories,filtered_restaurants:e.restaurant.filtered_restaurants,user:e.user.user})),{getRestaurantsBasedOnCategory:r.Hj,getRestaurantsCategories:r.bt})(S)}}]);