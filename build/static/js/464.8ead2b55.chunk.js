"use strict";(self.webpackChunksommelier=self.webpackChunksommelier||[]).push([[464],{3393:(e,t,s)=>{s.d(t,{A:()=>i});s(9950);var a=s(7764),o=s.n(a),n=s(4414);const i=o()((e=>{let{children:t,triggerLogin:s,...a}=e;return(0,n.jsx)("button",{onClick:s,...a,className:a.className,children:t})}))},1464:(e,t,s)=>{s.r(t),s.d(t,{default:()=>L});var a=s(9950),o=s(2920),n=s(9752),i=s(8858),l=s(2074),r=s(8429),d=s(72),c=s.n(d),g=s(3393),h=s(8341),u=s(9085),m=s(5136),p=s(413),v=s.n(p),f=s(4414);class x extends a.Component{constructor(){super(),this.state={loading:!1,email:"",onlyPhone:"",phone:"",password:"",otp:"",accessToken:"",provider:"",error:!1,email_phone_already_used:!1,invalid_otp:!1,showResendOtp:!1,countdownStart:!1,countDownSeconds:30,email_pass_error:!1,countryCodeSelect:"",isFoodomaaAndroidWebView:!1},this.handleInputChange=e=>{"phone"===e.target.name?(this.setState({phone:this.state.countryCodeSelect+e.target.value.replace(/^0+/,"")}),this.setState({onlyPhone:e.target.value.replace(/^0+/,"")})):this.setState({[e.target.name]:e.target.value.trim()})},this.handleCountryCodeChange=e=>{const{target:t}=e;this.setState({countryCodeSelect:t.value},(()=>{this.setState({phone:t.value+this.state.onlyPhone})}))},this.handleLogin=e=>{e.preventDefault(),this.validator.fieldValid("email")&&this.validator.fieldValid("password")?(this.setState({loading:!0}),this.props.loginUser(null,this.state.email,this.state.password,null,null,null,this.getLocationFromLocalStorage(),this.state.otp)):(console.log("validation failed"),this.validator.showMessages())},this.handleRegisterAfterSocialLogin=e=>{e.preventDefault(),this.setState({loading:!0}),this.validator.fieldValid("phone")?"true"===localStorage.getItem("enSOV")?this.props.sendOtp(this.state.email,this.state.phone,null).then((e=>{e.payload.otp||this.setState({error:!1})})):this.props.loginUser(this.state.name,this.state.email,null,this.state.accessToken,this.state.phone,this.state.provider,this.getLocationFromLocalStorage(),this.state.otp):(this.setState({loading:!1}),console.log("Validation Failed"),this.validator.showMessages())},this.resendOtp=()=>{this.validator.fieldValid("phone")&&(this.setState({countDownSeconds:15,showResendOtp:!1}),this.props.sendOtp(this.state.email,this.state.phone,null).then((e=>{e.payload.otp||this.setState({error:!1})})))},this.handleVerifyOtp=e=>{e.preventDefault(),console.log("verify otp clicked"),this.validator.fieldValid("otp")&&(this.setState({loading:!0}),this.props.verifyOtp(this.state.phone,this.state.otp))},this.handleOnChange=e=>{this.props.getSingleLanguageData(e.target.value),localStorage.setItem("userPreferedLanguage",e.target.value)},this.handleSocialLogin=e=>{"true"===localStorage.getItem("enSOV")?(this.setState({name:e._profile.name,email:e._profile.email,accessToken:e._token.accessToken,provider:e._provider,social_login:!0,loading:!0}),this.props.sendOtp(e._profile.email,null,e._token.accessToken,e._provider).then((e=>{e.payload.otp||this.setState({error:!1})}))):(this.setState({name:e._profile.name,email:e._profile.email,accessToken:e._token.accessToken,provider:e._provider,social_login:!0,loading:!0}),this.props.loginUser(e._profile.name,e._profile.email,null,e._token.accessToken,null,e._provider,this.getLocationFromLocalStorage(),this.state.otp))},this.handleSocialLoginFailure=e=>{console.log("Social Login Error",e)},this.handleCountDown=()=>{setTimeout((()=>{this.setState({showResendOtp:!0}),clearInterval(this.intervalID)}),31e3),this.intervalID=setInterval((()=>{console.log("interval going on"),this.setState({countDownSeconds:this.state.countDownSeconds-1})}),1e3)},this.processDefaultCountryCode=()=>{const e=localStorage.getItem("phoneCountryCode").split(",");return 0===e.length?(0,f.jsx)("span",{className:"country-code"}):1===e.length?(0,f.jsx)("span",{className:"country-code",children:e[0].replace(/\s/g,"")}):e.length>1?(0,f.jsx)("select",{name:"countryCodeSelect",onChange:this.handleCountryCodeChange,className:"country-code--dropdown",children:e.map((e=>(0,f.jsx)("option",{value:e.replace(/\s/g,""),children:e.replace(/\s/g,"")},e)))}):void 0},this.getLocationFromLocalStorage=()=>{const e=JSON.parse(localStorage.getItem("userSetAddress"));return null===e||e.hasOwnProperty("businessLocation")?null:e},this.validator=new(c())({autoForceUpdate:this,messages:{required:localStorage.getItem("fieldValidationMsg"),email:localStorage.getItem("emailValidationMsg"),regex:localStorage.getItem("phoneValidationMsg")}})}componentDidMount(){const e=localStorage.getItem("phoneCountryCode").split(",");this.setState({countryCodeSelect:e[0].replace(/\s/g,"")}),"false"===localStorage.getItem("enableFacebookLogin")&&"false"===localStorage.getItem("enableGoogleLogin")&&document.getElementById("socialLoginDiv")&&document.getElementById("socialLoginDiv").classList.add("hidden"),"true"!==localStorage.getItem("enableFacebookLogin")&&"true"!==localStorage.getItem("enableGoogleLogin")||setTimeout((()=>{this.refs.socialLogin&&this.refs.socialLogin.classList.remove("hidden"),this.refs.socialLoginLoader&&this.refs.socialLoginLoader.classList.add("hidden")}),500),"FoodomaaAndroidWebViewUA"===navigator.userAgent&&"undefined"!==window.Android&&this.setState({isFoodomaaAndroidWebView:!0})}componentWillReceiveProps(e){const{user:t}=this.props;if(t!==e.user&&this.setState({loading:!1}),e.user.success){if(null!==e.user.data.default_address){const t={lat:e.user.data.default_address.latitude,lng:e.user.data.default_address.longitude,address:e.user.data.default_address.address,house:e.user.data.default_address.house,tag:e.user.data.default_address.tag};localStorage.setItem("userSetAddress",JSON.stringify(t))}"FoodomaaAndroidWebViewUA"===navigator.userAgent&&"undefined"!==window.Android&&window.Android.registerFcm(e.user.data.auth_token)}if(e.user.email_phone_already_used&&this.setState({email_phone_already_used:!0}),e.user.otp&&(this.setState({email_phone_already_used:!1,error:!1}),document.getElementById("loginForm").classList.add("hidden"),document.getElementById("socialLoginDiv").classList.add("hidden"),document.getElementById("phoneFormAfterSocialLogin").classList.add("hidden"),document.getElementById("otpForm").classList.remove("hidden"),this.setState({countdownStart:!0}),this.handleCountDown(),this.validator.hideMessages()),e.user.valid_otp&&(this.setState({invalid_otp:!1,error:!1,loading:!0}),this.state.social_login?this.props.loginUser(this.state.name,this.state.email,null,this.state.accessToken,this.state.phone,this.state.provider,this.getLocationFromLocalStorage(),this.state.otp):this.props.registerUser(this.state.name,this.state.email,this.state.phone,this.state.password,this.getLocationFromLocalStorage(),this.state.otp),console.log("VALID OTP, REG USER NOW")),!1===e.user.valid_otp&&(console.log("Invalid OTP"),this.setState({invalid_otp:!0})),e.user||this.setState({error:!0}),e.user.proceed_login&&(this.setState({loading:!0}),console.log("From Social : user already exists"),this.props.loginUser(this.state.name,this.state.email,null,this.state.accessToken,null,this.state.provider,this.getLocationFromLocalStorage(),this.state.otp)),e.user.enter_phone_after_social_login&&(this.validator.hideMessages(),document.getElementById("loginForm").classList.add("hidden"),document.getElementById("socialLoginDiv").classList.add("hidden"),document.getElementById("phoneFormAfterSocialLogin").classList.remove("hidden"),console.log("ask to fill the phone number and send otp process...")),"DONOTMATCH"===e.user.data&&this.setState({error:!1,email_pass_error:!0}),this.props.languages!==e.languages)if(localStorage.getItem("userPreferedLanguage"))this.props.getSingleLanguageData(localStorage.getItem("userPreferedLanguage"));else if(e.languages.length){console.log("Fetching Translation Data...");const t=e.languages.filter((e=>1===e.is_default))[0].id;this.props.getSingleLanguageData(t)}}componentWillUnmount(){clearInterval(this.intervalID)}render(){if(window.innerWidth>768)return(0,f.jsx)(r.C5,{to:"/"});if(null===localStorage.getItem("storeColor"))return(0,f.jsx)(r.C5,{to:"/"});const{user:e}=this.props;if(e.success)return"1"===localStorage.getItem("fromCartToLogin")?(localStorage.removeItem("fromCartToLogin"),(0,f.jsx)(r.C5,{to:"/cart"})):(0,f.jsx)(r.C5,{to:"/my-account"});const t=JSON.parse(localStorage.getItem("state")).languages;return console.log(this.state.phone),(0,f.jsxs)(a.Fragment,{children:[this.state.error&&(0,f.jsx)("div",{className:"auth-error",children:(0,f.jsx)("div",{className:"error-shake",children:localStorage.getItem("loginErrorMessage")})}),this.state.email_phone_already_used&&(0,f.jsx)("div",{className:"auth-error",children:(0,f.jsx)("div",{className:"error-shake",children:localStorage.getItem("emailPhoneAlreadyRegistered")})}),this.state.invalid_otp&&(0,f.jsx)("div",{className:"auth-error",children:(0,f.jsx)("div",{className:"error-shake",children:localStorage.getItem("invalidOtpMsg")})}),this.state.email_pass_error&&(0,f.jsx)("div",{className:"auth-error",children:(0,f.jsx)("div",{className:"error-shake",children:localStorage.getItem("emailPassDonotMatch")})}),this.state.loading&&(0,f.jsx)(m.A,{}),(0,f.jsxs)("div",{className:"cust-auth-header",children:[(0,f.jsx)("div",{className:"input-group",children:(0,f.jsx)("div",{className:"input-group-prepend",children:(0,f.jsx)(n.A,{history:this.props.history})})}),(0,f.jsx)(v(),{right:!0,delay:500,children:(0,f.jsx)("img",{src:"/assets/img/various/login-illustration.png",className:"login-image pull-right",alt:"login-header"})}),(0,f.jsxs)("div",{className:"login-texts px-15 mt-30 pb-20",children:[(0,f.jsx)("span",{className:"login-title",children:localStorage.getItem("loginLoginTitle")}),(0,f.jsx)("br",{}),(0,f.jsx)("span",{className:"login-subtitle",children:localStorage.getItem("loginLoginSubTitle")})]})]}),(0,f.jsxs)("div",{className:"bg-white",children:[(0,f.jsxs)("form",{onSubmit:this.handleLogin,id:"loginForm",children:[(0,f.jsxs)("div",{className:"form-group px-15 pt-30",children:[(0,f.jsxs)("div",{className:"col-md-9 pb-5",children:[(0,f.jsx)("input",{type:"text",name:"email",onChange:this.handleInputChange,className:"form-control auth-input",placeholder:localStorage.getItem("loginLoginEmailLabel")}),this.validator.message("email",this.state.email,"required|email")]}),(0,f.jsxs)("div",{className:"col-md-9",children:[(0,f.jsx)("input",{type:"password",name:"password",onChange:this.handleInputChange,className:"form-control auth-input",placeholder:localStorage.getItem("loginLoginPasswordLabel")}),this.validator.message("password",this.state.password,"required")]})]}),(0,f.jsx)("div",{className:"mt-20 mx-15 d-flex justify-content-center",children:(0,f.jsx)("button",{type:"submit",className:"btn btn-main",style:{backgroundColor:localStorage.getItem("storeColor"),width:"90%",borderRadius:"4px"},children:localStorage.getItem("firstScreenLoginBtn")})})]}),(0,f.jsx)("form",{onSubmit:this.handleVerifyOtp,id:"otpForm",className:"hidden",children:(0,f.jsxs)("div",{className:"form-group px-15 pt-30",children:[(0,f.jsxs)("div",{className:"col-md-9",children:[(0,f.jsx)("input",{name:"otp",type:"tel",onChange:this.handleInputChange,className:"form-control auth-input",required:!0,placeholder:localStorage.getItem("otpSentMsg")}),this.validator.message("otp",this.state.otp,"required|numeric|min:4|max:6")]}),(0,f.jsx)("button",{type:"submit",className:"btn btn-main",style:{backgroundColor:localStorage.getItem("storeColor")},children:localStorage.getItem("verifyOtpBtnText")}),(0,f.jsxs)("div",{className:"mt-30 mb-10",children:[this.state.showResendOtp&&(0,f.jsxs)("div",{className:"resend-otp",onClick:this.resendOtp,children:[localStorage.getItem("resendOtpMsg")," ",this.state.phone]}),this.state.countDownSeconds>0&&(0,f.jsxs)("div",{className:"resend-otp countdown",children:[localStorage.getItem("resendOtpCountdownMsg")," ",this.state.countDownSeconds]})]})]})}),(0,f.jsx)("form",{onSubmit:this.handleRegisterAfterSocialLogin,id:"phoneFormAfterSocialLogin",className:"hidden",children:(0,f.jsxs)("div",{className:"form-group px-15 pt-30",children:[(0,f.jsxs)("label",{className:"col-12 auth-input-label",children:[localStorage.getItem("socialWelcomeText")," ",this.state.name,","]}),(0,f.jsxs)("label",{className:"col-12 auth-input-label",children:[localStorage.getItem("enterPhoneToVerify")," "]}),(0,f.jsx)("div",{className:"col-md-9 pb-5",children:(0,f.jsxs)("div",{children:[this.processDefaultCountryCode(),(0,f.jsxs)("span",{children:[(0,f.jsx)("input",{name:"phone",type:"tel",onChange:this.handleInputChange,className:"form-control phone-number-country-code auth-input"}),this.validator.message("phone",this.state.phone,["required",{regex:["^\\+[1-9]\\d{1,14}$"]},{min:["8"]}])]})]})}),(0,f.jsx)("button",{type:"submit",className:"btn btn-main",style:{backgroundColor:localStorage.getItem("storeColor")},children:localStorage.getItem("registerRegisterTitle")})]})}),!this.state.isFoodomaaAndroidWebView&&(0,f.jsxs)("div",{className:"text-center mt-3 mb-20",id:"socialLoginDiv",children:[(0,f.jsxs)("p",{className:"login-or mt-4",children:[" ",localStorage.getItem("socialLoginOrText")," "]}),(0,f.jsx)("div",{ref:"socialLoginLoader",children:(0,f.jsxs)(i.Ay,{height:60,width:400,speed:1.2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb",children:[(0,f.jsx)("rect",{x:"28",y:"0",rx:"0",ry:"0",width:"165",height:"45"}),(0,f.jsx)("rect",{x:"210",y:"0",rx:"0",ry:"0",width:"165",height:"45"})]})}),(0,f.jsxs)("div",{ref:"socialLogin",className:"hidden d-flex justify-content-center align-items-center",children:["true"===localStorage.getItem("enableFacebookLogin")&&(0,f.jsx)(g.A,{provider:"facebook",appId:localStorage.getItem("facebookAppId"),onLoginSuccess:this.handleSocialLogin,onLoginFailure:this.handleSocialLoginFailure,className:"facebook-login-button mr-3",children:(0,f.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,f.jsx)("div",{children:(0,f.jsx)("img",{src:"/assets/img/various/facebook.png",alt:"Facebook Login",className:"img-fluid",style:{width:"18px",marginRight:"10px"}})}),(0,f.jsx)("div",{style:{fontSize:"14px"},children:localStorage.getItem("facebookLoginButtonText")})]})}),"true"===localStorage.getItem("enableGoogleLogin")&&(0,f.jsx)(g.A,{provider:"google",appId:localStorage.getItem("googleAppId"),onLoginSuccess:this.handleSocialLogin,onLoginFailure:this.handleSocialLoginFailure,className:"google-login-button",children:(0,f.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,f.jsx)("div",{children:(0,f.jsx)("img",{src:"/assets/img/various/google.png",alt:"Google Login",className:"img-fluid",style:{width:"18px",marginRight:"10px"}})}),(0,f.jsx)("div",{style:{fontSize:"14px"},children:localStorage.getItem("googleLoginButtonText")})]})})]})]}),(0,f.jsx)("div",{children:(0,f.jsx)("div",{className:"wave-container login-bottom-wave",children:(0,f.jsxs)("svg",{viewBox:"0 0 120 28",className:"wave-svg",children:[(0,f.jsxs)("defs",{children:[(0,f.jsxs)("filter",{id:"goo",children:[(0,f.jsx)("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"1",result:"blur"}),(0,f.jsx)("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 13 -9",result:"goo"}),(0,f.jsx)("xfeBlend",{in:"SourceGraphic",in2:"goo"})]}),(0,f.jsx)("path",{id:"wave",d:"M 0,10 C 30,10 30,15 60,15 90,15 90,10 120,10 150,10 150,15 180,15 210,15 210,10 240,10 v 28 h -240 z"})]}),(0,f.jsx)("use",{id:"wave3",className:"wave",xlinkHref:"#wave",x:"0",y:"-2"}),(0,f.jsx)("use",{id:"wave2",className:"wave",xlinkHref:"#wave",x:"0",y:"0"})]})})}),(0,f.jsxs)("div",{className:"text-center mt-50 mb-20 auth-reg-text-block",children:[localStorage.getItem("loginDontHaveAccount")," ",(0,f.jsx)(l.k2,{to:"/register",style:{color:localStorage.getItem("storeColor")},className:"auth-reg-link",children:localStorage.getItem("firstScreenRegisterBtn")})]})]}),"true"===localStorage.getItem("enPassResetEmail")&&(0,f.jsx)("div",{className:"mt-4 d-flex align-items-center justify-content-center",children:(0,f.jsx)(l.k2,{to:"/login/forgot-password",style:{color:localStorage.getItem("storeColor")},className:"auth-forgot-password-btn",children:localStorage.getItem("forgotPasswordLinkText")})}),"null"!==localStorage.getItem("registrationPolicyMessage")?(0,f.jsx)("div",{className:"mt-20 mb-20 d-flex align-items-center justify-content-center auth-custom-msg-block",dangerouslySetInnerHTML:{__html:localStorage.getItem("registrationPolicyMessage")}}):(0,f.jsx)("div",{className:"mb-100"}),t&&t.length>1&&(0,f.jsxs)("div",{className:"mt-4 d-flex align-items-center justify-content-center mb-100",children:[(0,f.jsx)("div",{className:"mr-2",children:localStorage.getItem("changeLanguageText")}),(0,f.jsx)("select",{onChange:this.handleOnChange,defaultValue:localStorage.getItem("userPreferedLanguage")?localStorage.getItem("userPreferedLanguage"):t.filter((e=>1===e.is_default))[0].id,className:"form-control language-select",children:t.map((e=>(0,f.jsx)("option",{value:e.id,children:e.language_name},e.id)))})]})]})}}x.contextTypes={router:()=>null};const S=(0,h.Ng)((e=>({user:e.user.user,language:e.languages.language,languages:e.languages.languages})),{loginUser:o.Lx,registerUser:o.DY,sendOtp:o.Ix,verifyOtp:o.RY,getSingleLanguageData:u.l})(x);var j=s(2515),y=function(e){return"object"===typeof e&&null!==e},I=function(e){var t=e.value,s=void 0===t?"":t,o=e.numInputs,n=void 0===o?4:o,i=e.onChange,l=e.onPaste,r=e.renderInput,d=e.shouldAutoFocus,c=void 0!==d&&d,g=e.inputType,h=void 0===g?"text":g,u=e.renderSeparator,m=e.placeholder,p=e.containerStyle,v=e.inputStyle,f=e.skipDefaultStyles,x=void 0!==f&&f,S=a.useState(0),j=S[0],I=S[1],b=a.useRef([]),w=function(){return s?s.toString().split(""):[]},N="number"===h||"tel"===h;a.useEffect((function(){b.current=b.current.slice(0,n)}),[n]),a.useEffect((function(){var e;c&&(null===(e=b.current[0])||void 0===e||e.focus())}),[c]);var L=function(){if("string"===typeof m){if(m.length===n)return m;m.length>0&&console.error("Length of the placeholder should be equal to the number of inputs.")}},C=function(e){return(N?!isNaN(Number(e)):"string"===typeof e)&&1===e.trim().length},_=function(e){var t=e.target.value;C(t)&&(T(t),F(j+1))},D=function(e){var t=e.nativeEvent,s=e.target.value;if(!C(s)){if(s.length===n)s.split("").some((function(e){return!C(e)}))||(A(s.split("")),F(n-1));null===t.data&&"deleteContentBackward"===t.inputType&&(e.preventDefault(),T(""),F(j-1)),e.target.value=""}},O=function(){I(j-1)},k=function(e){var t=w();[e.code,e.key].includes("Backspace")?(e.preventDefault(),T(""),F(j-1)):"Delete"===e.code?(e.preventDefault(),T("")):"ArrowLeft"===e.code?(e.preventDefault(),F(j-1)):"ArrowRight"===e.code||e.key===t[j]?(e.preventDefault(),F(j+1)):"Spacebar"!==e.code&&"Space"!==e.code&&"ArrowUp"!==e.code&&"ArrowDown"!==e.code||e.preventDefault()},F=function(e){var t,s,a=Math.max(Math.min(n-1,e),0);b.current[a]&&(null===(t=b.current[a])||void 0===t||t.focus(),null===(s=b.current[a])||void 0===s||s.select(),I(a))},T=function(e){var t=w();t[j]=e[0],A(t)},A=function(e){var t=e.join("");i(t)},M=function(e){var t;e.preventDefault();var s=w(),a=j,o=e.clipboardData.getData("text/plain").slice(0,n-j).split("");if(!N||!o.some((function(e){return isNaN(Number(e))}))){for(var i=0;i<n;++i)i>=j&&o.length>0&&(s[i]=null!==(t=o.shift())&&void 0!==t?t:"",a++);F(a),A(s)}};return a.createElement("div",{style:Object.assign({display:"flex",alignItems:"center"},y(p)&&p),className:"string"===typeof p?p:void 0,onPaste:l},Array.from({length:n},(function(e,t){return t})).map((function(e){var t,s,o;return a.createElement(a.Fragment,{key:e},r({value:null!==(t=w()[e])&&void 0!==t?t:"",placeholder:null!==(o=null===(s=L())||void 0===s?void 0:s[e])&&void 0!==o?o:void 0,ref:function(t){return b.current[e]=t},onChange:_,onFocus:function(t){return function(e){return function(t){I(t),e.target.select()}}(t)(e)},onBlur:O,onKeyDown:k,onPaste:M,autoComplete:"off","aria-label":"Please enter OTP character ".concat(e+1),style:Object.assign(x?{}:{width:"1em",textAlign:"center"},y(v)?v:{}),className:"string"===typeof v?v:void 0,type:h,inputMode:N?"numeric":"text",onInput:D},e),e<n-1&&("function"===typeof u?u(e):u))})))};class b extends a.Component{constructor(){super(),this.state={loading:!1,email:"",phone:"",password:"",otp:"",numInputs:"6",error:!1,email_phone_already_used:!1,invalid_otp:!1,showResendOtp:!1,countdownStart:!1,countDownSeconds:30,email_pass_error:!1,countryCodeSelect:"",newUser:!1},this.handleInputChange=e=>{"phone"===e.target.name?(this.setState({phone:this.state.countryCodeSelect+e.target.value.replace(/^0+/,"")}),this.setState({onlyPhone:e.target.value.replace(/^0+/,"")})):this.setState({[e.target.name]:e.target.value.trim()})},this.handleOtpInput=e=>this.setState({otp:e}),this.handleCountryCodeChange=e=>{const{target:t}=e;this.setState({countryCodeSelect:t.value},(()=>{this.setState({phone:t.value+this.state.onlyPhone})}))},this.__sendOtp=e=>{e.preventDefault(),!this.state.newUser&&this.validator.fieldValid("phone")||this.state.newUser&&this.validator.fieldValid("phone")&&this.validator.fieldValid("email")?(this.setState({loading:!0}),this.props.generateOtpForLogin(this.state.phone,this.state.email)):(this.setState({loading:!1}),console.log("validation failed"),this.validator.showMessages())},this.__loginWithOtp=e=>{e.preventDefault(),this.props.loginWithOtp(this.state.phone,this.state.otp,this.state.name,this.state.email,this.getLocationFromLocalStorage()),this.setState({loading:!0})},this.handleCountDown=()=>{setTimeout((()=>{this.setState({showResendOtp:!0}),clearInterval(this.intervalID)}),31e3),this.intervalID=setInterval((()=>{console.log("interval going on"),this.setState({countDownSeconds:this.state.countDownSeconds-1})}),1e3)},this.resendOtp=()=>{this.validator.fieldValid("phone")&&(this.setState({countDownSeconds:15,showResendOtp:!1}),this.props.generateOtpForLogin(this.state.phone,this.state.email).then((e=>{e.payload.otp||this.setState({error:!1})})))},this.handleOnChange=e=>{this.props.getSingleLanguageData(e.target.value),localStorage.setItem("userPreferedLanguage",e.target.value)},this.handleCountDown=()=>{setTimeout((()=>{this.setState({showResendOtp:!0}),clearInterval(this.intervalID)}),31e3),this.intervalID=setInterval((()=>{console.log("interval going on"),this.setState({countDownSeconds:this.state.countDownSeconds-1})}),1e3)},this.processDefaultCountryCode=()=>{const e=localStorage.getItem("phoneCountryCode").split(",");return 0===e.length?(0,f.jsx)("span",{className:"country-code"}):1===e.length?(0,f.jsx)("span",{className:"country-code",children:e[0].replace(/\s/g,"")}):e.length>1?(0,f.jsx)("select",{name:"countryCodeSelect",onChange:this.handleCountryCodeChange,className:"country-code--dropdown",children:e.map((e=>(0,f.jsx)("option",{value:e.replace(/\s/g,""),children:e.replace(/\s/g,"")},e)))}):void 0},this.getLocationFromLocalStorage=()=>{const e=JSON.parse(localStorage.getItem("userSetAddress"));return null===e||e.hasOwnProperty("businessLocation")?null:e},this.validator=new(c())({autoForceUpdate:this,messages:{required:localStorage.getItem("fieldValidationMsg"),email:localStorage.getItem("emailValidationMsg"),regex:localStorage.getItem("phoneValidationMsg")}})}componentDidMount(){const e=localStorage.getItem("phoneCountryCode").split(",");this.setState({countryCodeSelect:e[0].replace(/\s/g,"")})}componentWillReceiveProps(e){const{user:t}=this.props;if(t!==e.user&&this.setState({loading:!1}),e.user.success){if(null!==e.user.data.default_address){const t={lat:e.user.data.default_address.latitude,lng:e.user.data.default_address.longitude,address:e.user.data.default_address.address,house:e.user.data.default_address.house,tag:e.user.data.default_address.tag};localStorage.setItem("userSetAddress",JSON.stringify(t))}"FoodomaaAndroidWebViewUA"===navigator.userAgent&&"undefined"!==window.Android&&window.Android.registerFcm(e.user.data.auth_token)}if(e.user.email_phone_already_used&&this.setState({email_phone_already_used:!0}),e.user.otp&&(this.setState({email_phone_already_used:!1,error:!1}),document.getElementById("loginForm").classList.add("hidden"),document.getElementById("otpForm").classList.remove("hidden"),this.setState({countdownStart:!0}),this.handleCountDown(),this.validator.hideMessages()),!e.user.otp&&e.user.new_user&&(console.log("New User"),this.setState({newUser:!0}),this.validator.hideMessages()),e.user||this.setState({error:!0}),e.user.enter_phone_after_social_login&&(this.validator.hideMessages(),document.getElementById("loginForm").classList.add("hidden"),console.log("ask to fill the phone number and send otp process...")),"DONOTMATCH"===e.user.data&&this.setState({error:!1,email_pass_error:!1,invalid_otp:!0}),this.props.languages!==e.languages)if(localStorage.getItem("userPreferedLanguage"))this.props.getSingleLanguageData(localStorage.getItem("userPreferedLanguage"));else if(e.languages.length){console.log("Fetching Translation Data...");const t=e.languages.filter((e=>1===e.is_default))[0].id;this.props.getSingleLanguageData(t)}}componentWillUnmount(){clearInterval(this.intervalID)}render(){if(window.innerWidth>768)return(0,f.jsx)(r.C5,{to:"/"});if(null===localStorage.getItem("storeColor"))return(0,f.jsx)(r.C5,{to:"/"});const{user:e}=this.props;if(e.success)return"1"===localStorage.getItem("fromCartToLogin")?(localStorage.removeItem("fromCartToLogin"),(0,f.jsx)(r.C5,{to:"/cart"})):(0,f.jsx)(r.C5,{to:"/my-account"});const t=this.props.languages;return(0,f.jsxs)(a.Fragment,{children:[this.state.error&&(0,f.jsx)("div",{className:"auth-error",children:(0,f.jsx)("div",{className:"error-shake",children:localStorage.getItem("loginErrorMessage")})}),this.state.email_phone_already_used&&(0,f.jsx)("div",{className:"auth-error",children:(0,f.jsx)("div",{className:"error-shake",children:localStorage.getItem("emailPhoneAlreadyRegistered")})}),this.state.invalid_otp&&(0,f.jsx)("div",{className:"auth-error",children:(0,f.jsx)("div",{className:"error-shake",children:localStorage.getItem("invalidOtpMsg")})}),this.state.loading&&(0,f.jsx)(m.A,{}),(0,f.jsxs)("div",{className:"cust-auth-header",children:[(0,f.jsx)("div",{className:"input-group",children:(0,f.jsx)("div",{className:"input-group-prepend",children:(0,f.jsx)(n.A,{history:this.props.history})})}),(0,f.jsx)(v(),{right:!0,delay:500,children:(0,f.jsx)("img",{src:"/assets/img/various/login-illustration.png",className:"login-image pull-right",alt:"login-header"})}),(0,f.jsx)("div",{className:"login-texts px-15 mt-30 pb-20",children:this.state.newUser?(0,f.jsxs)(a.Fragment,{children:[(0,f.jsx)("span",{className:"login-title",children:localStorage.getItem("registerRegisterTitle")}),(0,f.jsx)("br",{}),(0,f.jsx)("span",{className:"login-subtitle",children:localStorage.getItem("registerRegisterSubTitle")})]}):(0,f.jsxs)(a.Fragment,{children:[(0,f.jsx)("span",{className:"login-title",children:localStorage.getItem("loginLoginTitle")}),(0,f.jsx)("br",{}),(0,f.jsx)("span",{className:"login-subtitle",children:localStorage.getItem("loginLoginSubTitle")})]})})]}),(0,f.jsxs)("div",{className:"bg-white",children:[(0,f.jsxs)("form",{onSubmit:this.__sendOtp,id:"loginForm",children:[(0,f.jsxs)("div",{className:"form-group px-15 pt-30",children:[(0,f.jsx)("div",{className:"col-md-9 pb-5",children:(0,f.jsxs)("div",{children:[this.processDefaultCountryCode(),(0,f.jsxs)("span",{children:[(0,f.jsx)("input",{name:"phone",type:"tel",onChange:this.handleInputChange,className:"form-control phone-number-country-code auth-input",placeholder:localStorage.getItem("loginLoginPhoneLabel")}),this.validator.message("phone",this.state.phone,["required",{regex:["^\\+[1-9]\\d{1,14}$"]},{min:["8"]}])]})]})}),this.state.newUser&&(0,f.jsxs)("div",{id:"newUserFields",children:[(0,f.jsxs)("div",{className:"col-md-9 pb-5",children:[(0,f.jsx)("input",{type:"text",name:"name",onChange:this.handleInputChange,className:"form-control auth-input",placeholder:localStorage.getItem("loginLoginNameLabel")}),this.validator.message("name",this.state.name,"required|string")]}),(0,f.jsxs)("div",{className:"col-md-9 pb-5",children:[(0,f.jsx)("input",{type:"text",name:"email",onChange:this.handleInputChange,className:"form-control auth-input",placeholder:localStorage.getItem("loginLoginEmailLabel")}),this.validator.message("email",this.state.email,"required|email")]})]})]}),(0,f.jsx)("div",{className:"mt-20 mx-10 d-flex justify-content-center",children:(0,f.jsx)("button",{type:"submit",className:"btn btn-main",style:{backgroundColor:localStorage.getItem("storeColor"),width:"90%",borderRadius:"4px"},children:this.state.newUser?localStorage.getItem("registerRegisterTitle"):localStorage.getItem("firstScreenLoginBtn")})})]}),(0,f.jsx)("form",{onSubmit:this.__loginWithOtp,id:"otpForm",className:"hidden",children:(0,f.jsxs)("div",{className:"form-group px-15 pt-30",children:[(0,f.jsx)("div",{className:"col-md-9",children:(0,f.jsx)(I,{value:this.state.otp,onChange:this.handleOtpInput,numInputs:this.state.numInputs,isInputNum:!0,containerStyle:"login-with-otp-input-container",inputStyle:"login-with-otp-input",shouldAutoFocus:!0})}),(0,f.jsx)("div",{className:"col-md-9 mt-20",children:(0,f.jsx)("button",{type:"submit",className:"btn btn-main",style:{backgroundColor:localStorage.getItem("storeColor"),borderRadius:"4px"},disabled:this.state.otp.length<this.state.numInputs,children:localStorage.getItem("verifyOtpBtnText")})}),(0,f.jsxs)("div",{className:"mt-30 mb-10",children:[this.state.showResendOtp&&(0,f.jsxs)("div",{className:"resend-otp",onClick:this.resendOtp,children:[localStorage.getItem("resendOtpMsg")," ",this.state.phone]}),this.state.countDownSeconds>0&&(0,f.jsxs)("div",{className:"resend-otp countdown",children:[localStorage.getItem("resendOtpCountdownMsg")," ",this.state.countDownSeconds]})]})]})}),(0,f.jsx)("div",{children:(0,f.jsx)("div",{className:"wave-container login-bottom-wave",children:(0,f.jsxs)("svg",{viewBox:"0 0 120 28",className:"wave-svg",children:[(0,f.jsxs)("defs",{children:[(0,f.jsxs)("filter",{id:"goo",children:[(0,f.jsx)("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"1",result:"blur"}),(0,f.jsx)("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 13 -9",result:"goo"}),(0,f.jsx)("xfeBlend",{in:"SourceGraphic",in2:"goo"})]}),(0,f.jsx)("path",{id:"wave",d:"M 0,10 C 30,10 30,15 60,15 90,15 90,10 120,10 150,10 150,15 180,15 210,15 210,10 240,10 v 28 h -240 z"})]}),(0,f.jsx)("use",{id:"wave3",className:"wave",xlinkHref:"#wave",x:"0",y:"-2"}),(0,f.jsx)("use",{id:"wave2",className:"wave",xlinkHref:"#wave",x:"0",y:"0"})]})})})]}),this.state.newUser&&(0,f.jsx)(a.Fragment,{children:"null"!==localStorage.getItem("registrationPolicyMessage")?(0,f.jsx)("div",{className:"mt-20 mb-20 d-flex align-items-center justify-content-center auth-custom-msg-block",dangerouslySetInnerHTML:{__html:localStorage.getItem("registrationPolicyMessage")}}):(0,f.jsx)("div",{className:"mb-100"})}),t&&t.length>1&&(0,f.jsxs)("div",{className:"mt-4 d-flex align-items-center justify-content-center mb-100",children:[(0,f.jsx)("div",{className:"mr-2",children:localStorage.getItem("changeLanguageText")}),(0,f.jsx)("select",{onChange:this.handleOnChange,defaultValue:localStorage.getItem("userPreferedLanguage")?localStorage.getItem("userPreferedLanguage"):t.filter((e=>1===e.is_default))[0].id,className:"form-control language-select",children:t.map((e=>(0,f.jsx)("option",{value:e.id,children:e.language_name},e.id)))})]})]})}}b.contextTypes={router:()=>null};const w=(0,h.Ng)((e=>({user:e.user.user,language:e.languages.language,languages:e.languages.languages})),{loginWithOtp:o.T4,generateOtpForLogin:o.hx,getSingleLanguageData:u.l})(b);class N extends a.Component{constructor(){super(...arguments),this.state={enOLnR:""}}componentDidMount(){const e=this.props.settings&&this.props.settings.find((e=>"enOLnR"===e.key));this.setState({enOLnR:e.value})}render(){return(0,f.jsxs)(a.Fragment,{children:[(0,f.jsx)(j.A,{seotitle:localStorage.getItem("seoMetaTitle"),seodescription:localStorage.getItem("seoMetaDescription"),ogtype:"website",ogtitle:localStorage.getItem("seoOgTitle"),ogdescription:localStorage.getItem("seoOgDescription"),ogurl:window.location.href,twittertitle:localStorage.getItem("seoTwitterTitle"),twitterdescription:localStorage.getItem("seoTwitterDescription")}),"true"===this.state.enOLnR?(0,f.jsx)(w,{}):(0,f.jsx)(S,{})]})}}const L=(0,h.Ng)((e=>({settings:e.settings.settings})),{})(N)},9752:(e,t,s)=>{s.d(t,{A:()=>r});var a=s(9950),o=s(1580),n=s.n(o),i=s(4414);class l extends a.Component{render(){return(0,i.jsx)(a.Fragment,{children:(0,i.jsxs)("button",{type:"button",className:"btn search-navs-btns back-button",style:{position:"relative"},onClick:this.context.router.history.goBack,children:[(0,i.jsx)("i",{className:"si si-arrow-left"}),(0,i.jsx)(n(),{duration:"500"})]})})}}l.contextTypes={router:()=>null};const r=l},413:(e,t,s)=>{function a(e,t){var s=t.left,a=t.right,o=t.mirror,n=t.opposite,i=(s?1:0)|(a?2:0)|(o?16:0)|(n?32:0)|(e?64:0);if(g.hasOwnProperty(i))return g[i];if(!o!=!(e&&n)){var l=[a,s];s=l[0],a=l[1]}var r=s?"-100%":a?"100%":"0",c=e?"from {\n        opacity: 1;\n      }\n      to {\n        transform: translate3d("+r+", 0, 0) skewX(30deg);\n        opacity: 0;\n      }\n    ":"from {\n        transform: translate3d("+r+", 0, 0) skewX(-30deg);\n        opacity: 0;\n      }\n      60% {\n        transform: skewX(20deg);\n        opacity: 1;\n      }\n      80% {\n        transform: skewX(-5deg);\n        opacity: 1;\n      }\n      to {\n        transform: none;\n        opacity: 1;\n      }";return g[i]=(0,d.animation)(c),g[i]}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d.defaults,t=e.children,s=(e.out,e.forever),o=e.timeout,n=e.duration,i=void 0===n?d.defaults.duration:n,r=e.delay,c=void 0===r?d.defaults.delay:r,g=e.count,h=void 0===g?d.defaults.count:g,u=function(e,t){var s={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(s[a]=e[a]);return s}(e,["children","out","forever","timeout","duration","delay","count"]),m={make:a,duration:void 0===o?i:o,delay:c,forever:s,count:h,style:{animationFillMode:"both"}};return u.left,u.right,u.mirror,u.opposite,(0,l.default)(u,m,m,t)}Object.defineProperty(t,"__esModule",{value:!0});var n,i=s(7374),l=(n=i)&&n.__esModule?n:{default:n},r=s(1942),d=s(7244),c={out:r.bool,left:r.bool,right:r.bool,mirror:r.bool,opposite:r.bool,duration:r.number,timeout:r.number,delay:r.number,count:r.number,forever:r.bool},g={};o.propTypes=c,t.default=o,e.exports=t.default}}]);