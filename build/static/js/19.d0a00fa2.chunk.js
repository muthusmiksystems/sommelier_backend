"use strict";(self.webpackChunksommelier=self.webpackChunksommelier||[]).push([[19],{19:(e,t,s)=>{s.r(t),s.d(t,{default:()=>m});var a=s(9950),o=s(72),r=s.n(o),i=s(8429),l=s(9752),n=s(8341),d=s(2920),c=s(4414);class h extends a.Component{constructor(){super(),this.state={loading:!1,email:"",code:"",password:"",show_mail_form:!0,show_code_validation_form:!1,show_password_change_form:!1,error:!1,error_msg:"",dontHaveOtp:!0,completed:!1},this.handleInputChange=e=>{this.setState({[e.target.name]:e.target.value})},this.handleAlreadyHaveOtp=()=>{this.validator.fieldValid("email")?this.setState({show_mail_form:!1,show_code_validation_form:!0,dontHaveOtp:!1},(()=>{this.refs.otpInput.focus()})):(this.refs.emailInput.focus(),this.validator.showMessages())},this.handleDontHaveOtp=()=>{this.setState({show_mail_form:!0,show_code_validation_form:!1,dontHaveOtp:!0},(()=>{this.refs.emailInput.focus()}))},this.handleSendEmail=e=>{e.preventDefault(),this.validator.fieldValid("email")?(this.refs.otpEmailSendBtn.setAttribute("disabled","disabled"),this.props.sendPasswordResetMail(this.state.email),this.setState({loading:!0})):(console.log("Email Validation Failed"),this.validator.showMessages(),this.refs.emailInput.focus())},this.handleValidateCode=e=>{e.preventDefault(),this.validator.fieldValid("code")?(this.refs.otpVerifyBtn.setAttribute("disabled","disabled"),this.props.verifyPasswordResetOtp(this.state.email,this.state.code),this.setState({loading:!0})):(console.log("Code Validation Failed"),this.validator.showMessages(),this.refs.otpInput.focus())},this.handleChangePassword=e=>{e.preventDefault(),this.validator.fieldValid("password")?(this.refs.changePassBtn.setAttribute("disabled","disabled"),this.props.changeUserPassword(this.state.email,this.state.code,this.state.password),this.setState({loading:!0})):(console.log("Password Validation Failed"),this.validator.showMessages(),this.refs.passwordInput.focus())},this.validator=new(r())({autoForceUpdate:this,messages:{required:localStorage.getItem("fieldValidationMsg"),email:localStorage.getItem("emailValidationMsg"),min:localStorage.getItem("minimumLengthValidationMessage")}})}componentWillReceiveProps(e){this.props.reset_mail!==e.reset_mail&&(e.reset_mail.success?(console.log("Mail Sending Success"),this.setState({loading:!1,show_mail_form:!1,show_code_validation_form:!0,show_password_change_form:!1})):(console.log("Mail Sending Failed"),this.refs.otpEmailSendBtn.removeAttribute("disabled","disabled"),this.setState({loading:!1,error:!0}),"UNF"===e.reset_mail.error_code?this.setState({error_msg:localStorage.getItem("userNotFoundErrorMessage")}):this.setState({error_msg:localStorage.getItem("loginErrorMessage")}))),this.props.validate_email_otp!==e.validate_email_otp&&(e.validate_email_otp.success?(console.log("OTP Validation Success"),this.setState({loading:!1,show_mail_form:!1,show_code_validation_form:!1,show_password_change_form:!0})):(console.log("OTP Validation Failed"),this.refs.otpVerifyBtn.removeAttribute("disabled","disabled"),this.setState({loading:!1,error:!0}),"UNF"===e.validate_email_otp.error_code&&(console.log("userNotFoundErrorMessage"),this.setState({error_msg:localStorage.getItem("userNotFoundErrorMessage")})),"IVOTP"===e.validate_email_otp.error_code&&(console.log("invalidOtpErrorMessage"),this.setState({error_msg:localStorage.getItem("invalidOtpErrorMessage")})),"SWR"===e.validate_email_otp.error_code&&(console.log("loginErrorMessage"),this.setState({error_msg:localStorage.getItem("loginErrorMessage")})))),this.props.change_password!==e.change_password&&(e.change_password.success?(console.log("Password Change Success"),this.setState({loading:!1,show_mail_form:!1,show_code_validation_form:!1,show_password_change_form:!1,error:!1,completed:!0},(()=>{setTimeout((()=>{console.log("Navigateing to login page"),this.context.router.history.push("/login")}),2e3)}))):(console.log("Password Change Failed"),this.refs.changePassBtn.removeAttribute("disabled","disabled"),this.setState({loading:!1,error:!0}),"UNF"===e.change_password.error_code&&this.setState({error_msg:localStorage.getItem("userNotFoundErrorMessage")}),"IVOTP"===e.change_password.error_code&&this.setState({error_msg:localStorage.getItem("invalidOtpErrorMessage")}),"SWR"===e.change_password.error_code&&this.setState({error_msg:localStorage.getItem("loginErrorMessage")})))}render(){return window.innerWidth>768||null===localStorage.getItem("storeColor")?(0,c.jsx)(i.C5,{to:"/"}):(0,c.jsxs)(a.Fragment,{children:[this.state.error&&(0,c.jsx)("div",{className:"auth-error",children:(0,c.jsx)("div",{className:"error-shake",children:this.state.error_msg})}),(0,c.jsxs)("div",{style:{backgroundColor:"#f2f4f9"},children:[(0,c.jsx)("div",{className:"input-group",children:(0,c.jsx)("div",{className:"input-group-prepend",children:(0,c.jsx)(l.A,{history:this.props.history})})}),(0,c.jsx)("img",{src:"/assets/img/login-header.png",className:"login-image pull-right mr-15",alt:"login-header"}),(0,c.jsxs)("div",{className:"login-texts px-15 mt-50 pb-20",children:[(0,c.jsx)("span",{className:"login-title",children:localStorage.getItem("resetPasswordPageTitle")}),(0,c.jsx)("br",{}),(0,c.jsx)("span",{className:"login-subtitle",children:localStorage.getItem("resetPasswordPageSubTitle")})]})]}),(0,c.jsxs)("div",{className:"bg-white",children:[this.state.show_mail_form&&(0,c.jsxs)(a.Fragment,{children:[(0,c.jsxs)("form",{onSubmit:this.handleSendEmail,children:[(0,c.jsxs)("div",{className:"form-group px-15 pt-30",children:[(0,c.jsxs)("label",{className:"col-12 edit-address-input-label",children:[localStorage.getItem("loginLoginEmailLabel")," ",this.validator.message("email",this.state.email,"required|email")]}),(0,c.jsx)("div",{className:"col-md-9 pb-5",children:(0,c.jsx)("input",{type:"text",name:"email",onChange:this.handleInputChange,className:"form-control edit-address-input",ref:"emailInput"})})]}),(0,c.jsx)("div",{className:"mt-20 px-15 pt-15 button-block",children:(0,c.jsx)("button",{type:"submit",className:"btn btn-main",style:{backgroundColor:localStorage.getItem("storeColor")},ref:"otpEmailSendBtn",required:!0,children:localStorage.getItem("sendOtpOnEmailButtonText")})})]}),this.state.dontHaveOtp&&(0,c.jsx)("div",{className:"d-flex justify-content-center mt-50",children:(0,c.jsx)("div",{className:"p-10 btn resend-otp w-75",onClick:this.handleAlreadyHaveOtp,children:localStorage.getItem("alreadyHaveResetOtpButtonText")})})]}),this.state.show_code_validation_form&&(0,c.jsxs)(a.Fragment,{children:[(0,c.jsxs)("form",{onSubmit:this.handleValidateCode,children:[(0,c.jsxs)("div",{className:"form-group px-15 pt-30",children:[(0,c.jsxs)("label",{className:"col-12 edit-address-input-label",children:[localStorage.getItem("enterResetOtpMessageText")," ",this.state.email," ",this.validator.message("code",this.state.code,"required")]}),(0,c.jsx)("div",{className:"col-md-9 pb-5",children:(0,c.jsx)("input",{ref:"otpInput",type:"text",name:"code",onChange:this.handleInputChange,className:"form-control edit-address-input",required:!0})})]}),(0,c.jsx)("div",{className:"mt-20 px-15 pt-15 button-block",children:(0,c.jsx)("button",{type:"submit",className:"btn btn-main",style:{backgroundColor:localStorage.getItem("storeColor")},ref:"otpVerifyBtn",children:localStorage.getItem("verifyResetOtpButtonText")})})]}),!this.state.dontHaveOtp&&(0,c.jsx)("div",{className:"d-flex justify-content-center mt-50",children:(0,c.jsx)("div",{className:"p-10 btn resend-otp w-75",onClick:this.handleDontHaveOtp,children:localStorage.getItem("dontHaveResetOtpButtonText")})})]}),this.state.show_password_change_form&&(0,c.jsxs)("form",{onSubmit:this.handleChangePassword,children:[(0,c.jsx)("p",{className:"text-muted font-w700 px-15 mt-20 mb-0",children:localStorage.getItem("enterNewPasswordText")}),(0,c.jsxs)("div",{className:"form-group px-15 pt-30",children:[(0,c.jsxs)("label",{className:"col-12 edit-address-input-label",children:[localStorage.getItem("newPasswordLabelText")," ",this.validator.message("password",this.state.password,"required|min:8")]}),(0,c.jsx)("div",{className:"col-md-9 pb-5",children:(0,c.jsx)("input",{ref:"passwordInput",type:"text",name:"password",onChange:this.handleInputChange,className:"form-control edit-address-input",required:!0})})]}),(0,c.jsx)("div",{className:"mt-20 px-15 pt-15 button-block",children:(0,c.jsx)("button",{type:"submit",className:"btn btn-main",style:{backgroundColor:localStorage.getItem("storeColor")},ref:"changePassBtn",children:localStorage.getItem("setNewPasswordButtonText")})})]}),this.state.loading&&(0,c.jsx)("div",{className:"d-flex justify-content-center",children:(0,c.jsx)("img",{src:"/assets/img/various/spinner.svg",alt:"Loading...",style:{width:"50px"}})}),this.state.completed&&(0,c.jsx)("div",{className:"d-flex justify-content-center mt-20",children:(0,c.jsx)("img",{src:"/assets/img/order-placed.gif",alt:"Completed",style:{width:"100px"}})})]})]})}}h.contextTypes={router:()=>null};const m=(0,n.Ng)((e=>({user:e.user.user,reset_mail:e.user.reset_mail,validate_email_otp:e.user.validate_email_otp,change_password:e.user.change_password})),{sendPasswordResetMail:d.om,verifyPasswordResetOtp:d.ZO,changeUserPassword:d.dR})(h)},9752:(e,t,s)=>{s.d(t,{A:()=>n});var a=s(9950),o=s(1580),r=s.n(o),i=s(4414);class l extends a.Component{render(){return(0,i.jsx)(a.Fragment,{children:(0,i.jsxs)("button",{type:"button",className:"btn search-navs-btns back-button",style:{position:"relative"},onClick:this.context.router.history.goBack,children:[(0,i.jsx)("i",{className:"si si-arrow-left"}),(0,i.jsx)(r(),{duration:"500"})]})})}}l.contextTypes={router:()=>null};const n=l}}]);